<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>After Effects Batch Replace Script Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple scrollbar styling for webkit browsers */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #2d3748;
        }
        ::-webkit-scrollbar-thumb {
            background: #4a5568;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-4xl bg-gray-800 rounded-xl shadow-2xl p-6 md:p-8 space-y-6">
        <!-- Header -->
        <div class="text-center">
            <h1 class="text-2xl md:text-3xl font-bold text-white">AE Batch Replace Script Generator</h1>
            <p class="text-gray-400 mt-2">Generate a .jsx script to replace footage in After Effects.</p>
        </div>

        <!-- Step 1: Choose Footage Pack -->
        <div class="space-y-2">
            <label for="footagePack" class="block font-semibold text-gray-300">1. Choose Footage Source</label>
            <select id="footagePack" class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                <option value="custom">Custom List</option>
                <option value="blackwing">Blackwing Footage Pack</option>
            </select>
        </div>

        <!-- Step 2: Paste File Paths -->
        <div class="space-y-2">
            <label for="filePaths" class="block font-semibold text-gray-300">2. Paste File Paths (one per line)</label>
            <textarea id="filePaths" rows="10" class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" placeholder="\\server\share\file1.mov&#10;\\server\share\file2.mp4&#10;C:\Users\YourName\Videos\clip3.mkv"></textarea>
        </div>

        <!-- Step 3: Choose Script Type -->
        <div class="space-y-3">
            <label class="block font-semibold text-gray-300">3. Choose Script Type</label>
            <div class="flex flex-col sm:flex-row gap-4">
                <label class="flex-1 bg-gray-700 p-4 rounded-lg border-2 border-gray-600 has-[:checked]:border-blue-500 has-[:checked]:bg-gray-900 transition cursor-pointer">
                    <input type="radio" name="scriptType" value="project" class="sr-only" checked>
                    <div class="flex flex-col">
                        <span class="font-bold text-white">Replace in Project Panel</span>
                        <span class="text-sm text-gray-400">Replaces selected footage items in the project browser.</span>
                    </div>
                </label>
                <label class="flex-1 bg-gray-700 p-4 rounded-lg border-2 border-gray-600 has-[:checked]:border-blue-500 has-[:checked]:bg-gray-900 transition cursor-pointer">
                    <input type="radio" name="scriptType" value="layers" class="sr-only">
                     <div class="flex flex-col">
                        <span class="font-bold text-white">Replace Selected Layers</span>
                        <span class="text-sm text-gray-400">Replaces selected layers in the active composition.</span>
                    </div>
                </label>
            </div>
        </div>

        <!-- Generate Button -->
        <button id="generateBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg text-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-800">
            Generate Script
        </button>

        <!-- Output Section -->
        <div id="outputContainer" class="hidden mt-6 space-y-4">
            <div class="flex flex-wrap justify-between items-center gap-4">
                <h2 class="text-xl font-semibold text-white">Generated Script</h2>
                <div class="flex gap-2">
                     <button id="copyBtn" class="bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg transition">
                        Copy to Clipboard
                    </button>
                    <button id="downloadBtn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">
                        Download .jsx
                    </button>
                </div>
            </div>
            <pre class="bg-gray-900 rounded-lg p-4 border border-gray-700 max-h-96 overflow-auto"><code id="scriptOutput" class="text-sm text-yellow-300"></code></pre>
            <div id="copy-success" class="text-green-400 text-center font-medium hidden">Copied to clipboard!</div>
        </div>
    </div>

    <script>
        // --- DATA ---
        const blackwingFootagePack = [
            "\\\\192.168.1.207\\DaleG\\2025\\1-7\\blackwing v idle.mp4",
            "\\\\192.168.1.207\\DaleG\\2025\\1-6\\blackwing idle 3.mp4",
            "\\\\192.168.1.207\\DaleG\\2025\\1-6\\blackwing idle 2.mp4",
            "\\\\192.168.1.207\\DaleG\\2025\\1-3\\blackwing idle.mp4",
            "\\\\192.168.1.207\\ChaseFarrow\\Reels For Tommy\\Blackwing Dyno Pull 1.mp4",
            "\\\\192.168.1.207\\ChaseFarrow\\Videos\\1.) Magnificent Obsession\\Events\\We Built the Worlds Fastest Stick Shift Blackwing!.mkv",
            "\\\\192.168.1.207\\ChaseFarrow\\Videos\\1.) Magnificent Obsession\\Cars\\CT5-V\\Blackwing Tail Focus Fix_prob4.mp4",
            "\\\\192.168.1.207\\AidanOwnby\\Desktop\\Downloads\\Giving the CT5-V Blackwing some quick upgrades + Exhaust sound.mp4",
            "\\\\192.168.1.207\\ChaseFarrow\\General Footage\\Events\\Blackwing Track Day\\Drone\\AI HFR\\Blackwing TMP_1_apo8.mp4",
            "\\\\192.168.1.207\\ChaseFarrow\\Cars\\WIKD\\WIKD Blackwing\\HFR\\Blackwing Rear Brake (HFR).mp4",
            "\\\\192.168.1.207\\AidanOwnby\\Backups\\XD9 Pro Backup\\youtube shorts vertical\\blackwing vs ws6\\IMG_6609.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Backups\\XD9 Pro Backup\\youtube shorts vertical\\blackwing vs ws6\\IMG_6605.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Backups\\XD9 Pro Backup\\youtube shorts vertical\\blackwing vs ws6\\IMG_6607.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1697.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1698.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1654.mov",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1655.mov",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1658.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1659.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1660.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1662.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1663.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1664.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1665.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1666.mov",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1667.mov",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1669.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1673.mov",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1676.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1677.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1678.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1679.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1681.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1683.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1684.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1686.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1687.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1688.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1690.mov",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1692.mov",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1693.mov",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1694.MOV",
            "\\\\192.168.1.207\\AidanOwnby\\Cars\\Customer Cars\\RIFT\\CT5-V short\\IMG_1696.MOV"
        ];

        // --- DOM ELEMENTS ---
        const footagePackSelect = document.getElementById('footagePack');
        const filePathsTextarea = document.getElementById('filePaths');
        const generateBtn = document.getElementById('generateBtn');
        const outputContainer = document.getElementById('outputContainer');
        const scriptOutput = document.getElementById('scriptOutput');
        const copyBtn = document.getElementById('copyBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const copySuccessMessage = document.getElementById('copy-success');

        // --- EVENT LISTENERS ---
        footagePackSelect.addEventListener('change', (e) => {
            if (e.target.value === 'blackwing') {
                filePathsTextarea.value = blackwingFootagePack.join('\n');
            } else {
                filePathsTextarea.value = '';
            }
        });

        generateBtn.addEventListener('click', () => {
            const paths = filePathsTextarea.value.split('\n')
                .map(p => p.trim().replace(/['"]+/g, '')) // Clean up quotes and whitespace
                .filter(p => p.length > 0); // Remove empty lines

            if (paths.length === 0) {
                alert('Please provide at least one file path.');
                return;
            }

            const scriptType = document.querySelector('input[name="scriptType"]:checked').value;
            const generatedScript = scriptType === 'project' 
                ? generateProjectReplaceScript(paths) 
                : generateLayerReplaceScript(paths);

            scriptOutput.textContent = generatedScript;
            outputContainer.classList.remove('hidden');
            copySuccessMessage.classList.add('hidden');
            copyBtn.textContent = 'Copy to Clipboard';
        });
        
        copyBtn.addEventListener('click', () => {
            const textToCopy = scriptOutput.textContent;
            
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = textToCopy;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            
            try {
                document.execCommand('copy');
                copyBtn.textContent = 'Copied!';
                copySuccessMessage.classList.remove('hidden');
            } catch (err) {
                console.error('Failed to copy text: ', err);
                copyBtn.textContent = 'Copy Failed';
            }
            
            document.body.removeChild(tempTextArea);
        });

        downloadBtn.addEventListener('click', () => {
            const scriptContent = scriptOutput.textContent;
            if (!scriptContent) {
                alert('Please generate a script first.');
                return;
            }

            const blob = new Blob([scriptContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            
            a.href = url;
            a.download = 'ae_batch_replace.jsx';
            document.body.appendChild(a);
            a.click();
            
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        // --- SCRIPT GENERATION FUNCTIONS ---

        function formatPathsForScript(paths) {
            // Escape backslashes for JS string and wrap in quotes
            return paths.map(p => `"${p.replace(/\\/g, '\\\\')}"`).join(',\n        ');
        }

        function generateProjectReplaceScript(paths) {
            const formattedPaths = formatPathsForScript(paths);
            return `// After Effects Script: Replace Footage in Project Panel
// How to use:
// 1. Save this file with a .jsx extension.
// 2. In After Effects, select the footage items in the Project Panel in the order you want them replaced.
// 3. Go to File > Scripts > Run Script File... and select this .jsx file.

(function replaceProjectFootage() {
    var newFilePaths = [
        ${formattedPaths}
    ];

    app.beginUndoGroup("Batch Replace Project Footage");

    try {
        var selectedItems = app.project.selection;
        var footageItems = [];

        for (var i = 0; i < selectedItems.length; i++) {
            if (selectedItems[i] instanceof FootageItem) {
                footageItems.push(selectedItems[i]);
            }
        }

        if (footageItems.length === 0) {
            alert("Please select one or more footage items in the Project panel.");
            return;
        }

        if (newFilePaths.length !== footageItems.length) {
            alert("Error: The number of file paths (" + newFilePaths.length + ") does not match the number of selected footage items (" + footageItems.length + ").");
            return;
        }

        for (var j = 0; j < footageItems.length; j++) {
            var currentItem = footageItems[j];
            var newFile = new File(newFilePaths[j]);

            if (newFile.exists) {
                currentItem.replace(newFile);
            } else {
                alert("Skipping: File not found at path:\\n" + newFilePaths[j]);
            }
        }
        alert("Replacement complete! " + footageItems.length + " footage items have been updated.");

    } catch (e) {
        alert("An error occurred: " + e.toString());
    } finally {
        app.endUndoGroup();
    }
})();`;
        }
        
        function generateLayerReplaceScript(paths) {
            const formattedPaths = formatPathsForScript(paths);
            return `// After Effects Script: Replace Selected Layers in Composition
// How to use:
// 1. Save this file with a .jsx extension.
// 2. In After Effects, open your composition and select the layers in the timeline in the order you want them replaced.
// 3. Go to File > Scripts > Run Script File... and select this .jsx file.

(function replaceLayerFootage() {
    var newFilePaths = [
        ${formattedPaths}
    ];

    app.beginUndoGroup("Batch Replace Layer Sources");

    try {
        var comp = app.project.activeItem;
        if (!(comp instanceof CompItem)) {
            alert("Please select a composition first.");
            return;
        }

        var selectedLayers = comp.selectedLayers;
        if (selectedLayers.length === 0) {
            alert("Please select the layers you want to replace in the timeline.");
            return;
        }

        if (newFilePaths.length !== selectedLayers.length) {
            alert("Error: The number of file paths (" + newFilePaths.length + ") does not match the number of selected layers (" + selectedLayers.length + ").");
            return;
        }

        for (var i = 0; i < selectedLayers.length; i++) {
            var layer = selectedLayers[i];
            var newFile = new File(newFilePaths[i]);

            if (!newFile.exists) {
                alert("Skipping: File not found at path:\\n" + newFilePaths[i]);
                continue;
            }

            var importOptions = new ImportOptions(newFile);
            var newFootageItem = app.project.importFile(importOptions);
            layer.replaceSource(newFootageItem, true);
        }
        alert("Replacement complete! " + selectedLayers.length + " layers have been updated.");

    } catch (e) {
        alert("An error occurred: " + e.toString());
    } finally {
        app.endUndoGroup();
    }
})();`;
        }

    </script>
</body>
</html>
